# Aumentando a cobertura da aplicaÃ§Ã£o _Cypress Simulator_

Ao trabalhar no Ãºltimo exercÃ­cio da aula anterior, vocÃª deve ter percebido um cenÃ¡rio novo, no qual, Ã s vezes, a simulaÃ§Ã£o de um comando do Cypress nÃ£o funciona e gera "um erro na Matrix".

> ğŸ‘¨â€ğŸ« Caso nÃ£o tenha percebido, coloque um `.only` no teste que simula a execuÃ§Ã£o de um comando do Cypress com sucesso e execute-o localmente utilizando a Cypress App.

No entanto, isso Ã© sÃ³ a simulaÃ§Ã£o de um erro, criada exatamente para te ensinar sobre a fucionalidade de _test retries_.

A idÃ©ia foi simular o que ocorreria quando, por exemplo, uma API da qual o _frontend_ depende esteja "fora do ar".

Implementei tal simulaÃ§Ã£o de erro de forma que ela ocorra somente em um por cento dos casos, por isso que no exercÃ­cio anterior executamos o mesmo teste cem vezes.

E quando eu criei tal simulaÃ§Ã£o, tambÃ©m a criei de forma que seja possÃ­vel alterar esse percentual, com o uso da _feature flag_ `chancesOfError`.

- Se `chancesOfError=0`, o erro nunca vai ocorrer
- Se `chancesOfError=1`, o erro vai ocorrer em 100% dos casos
- Se `chancesOfError=0.5`, o erro vai ocorrer em 50% dos casos
- E assim por diante.

## ExercÃ­cio 1 ğŸ¯ - `chancesOfError=0`

Teu exercÃ­cio Ã©:

- Remover o teste que simula a execuÃ§Ã£o de um comando do Cypress com sucesso de dentro do `Cypress._.times()`
- Alterar sua pre-condiÃ§Ã£o (o `cy.visit` que vem logo apÃ³s o login) para que tal erro nunca ocorra
  - Para isso, use a _feature flag_ `chancesOfError=0`

> ğŸ‘¨â€ğŸ« Lembre-se de versionar as mudanÃ§as com o git e enviÃ¡-las ao GitHub.
>
> ğŸ‘¨â€ğŸ« Caso necessÃ¡rio, adicione a _feature flag_ `chancesOfError=0`em algum outro teste o qual possa falhar pelo "erro na Matrix".

## ExercÃ­cio 2 ğŸ¯ - `chancesOfError=1`

Agora, implemente o teste que exibe um erro sempre que a simulaÃ§Ã£o de um comando do Cypress seja executada.

> ğŸ§‘â€ğŸ« Aqui vai uma sugestÃ£o de descriÃ§Ã£o para o caso de teste: `it errors out with a glitch in the Matrix`.
>
> ğŸ§‘â€ğŸ« Este teste pode ser implementado no arquivo `cypress/e2e/cypress-simulator.cy.js`.
>
> ğŸ™Š Lembre-se que para garantir que o erro sempre vai ocorrer, deve-se usar a _feature flag_ `chancesOfError` igual a `1`.
>
> ğŸ‘¨â€ğŸ« Lembre-se de versionar as mudanÃ§as com o git e enviÃ¡-las ao GitHub.

___

ParabÃ©ns! ğŸ‰ Vamos para a [liÃ§Ã£o 20](./20.md) para eu te apresentar algumas outras iniciativas da Talking About Testing.
